<html>

<head>
<link rel="stylesheet" type="text/css" href="css/main.css" />
<script src="javascript/TestWebsiteJS.js"></script>

<script src="jquery-ui-1.8.20.custom/development-bundle/jquery-1.7.2.js"></script>
<script src="jquery-ui-1.8.20.custom/development-bundle/ui/jquery.ui.core.js"></script>
<script src="jquery-ui-1.8.20.custom/development-bundle/ui/jquery.ui.widget.js"></script>
<script src="jquery-ui-1.8.20.custom/development-bundle/ui/jquery.ui.mouse.js"></script>
<script src="jquery-ui-1.8.20.custom/development-bundle/ui/jquery.ui.draggable.js"></script>
<script src="jquery-ui-1.8.20.custom/development-bundle/ui/jquery.ui.droppable.js"></script>
<script src="jquery-ui-1.8.20.custom/development-bundle/ui/jquery.ui.sortable.js"></script>

<script>
$(function() {
		$(this).makeDroppable();
	});
	

$.fn.newGroup = function() {
	$("#groupList").append("<li class = 'icon group connectedSortable'><div onclick='$(this).hide5();'>New Group</div><ul class = 'apple'></ul></li>");
	$(this).makeDroppable(); /* Makes new group droppable */
};

$.fn.makeDroppable = function() {
		$( "#participantList li" ).draggable({
			/*appendTo: "body",*/
			helper: "clone",
			cursorAt: { left: 30, top: 30},
			connectToSortable: "#nserc #facet",
			opacity: 0.5,
		});
		
		/* Everything with the .group class will be droppable, and it'll append it to children with the .apple class */
		$( ".group" ).droppable({
			accept: ":not(.ui-sortable-helper)",
			drop: function( event, ui ) {
				$( this ).find(".apple").show(); /* When a new item is added, the group is expanded */
				$( this ).find( ".placeholder" ).remove();
				$( "<li class='icon user'></li>" ).text( ui.draggable.text() ).appendTo( jQuery(".apple",this));
			}
		});
				
		/* All groups need .group class and .connectedSortable class to join together for sorting */
		$( ".group" ).sortable({
			items: "li:not(.placeholder)",
			connectWith: ".connectedSortable",
			distance: 15,
		}).disableSelection();
};

$.fn.hide5 = function() {

	$(this).next().toggle();
};

</script>

<!-- https://github.com/furf/jquery-ui-touch-punch
Hack to get drag and drop to work on touch devices-->
<script src="javascript/jquery.ui.touch-punch.min.js"></script>
</head>

<body>

<div id="header">
<h1>Participants</h1></div>

<div id="content">

<ul class = "apple" id="participantList">
<li class="user icon"><a href='#'>Byron</a></li>
<li class="user icon"><a href="mailto:chnewton@hotmail.com">Charles</a></li>
<li class="user icon"><a href="mailto:chouston@facet.com">Christopher</a></li>
<li class="user icon"><a href="mailto:sabourid@ucalgary.ca">Daniel</a></li>
<li class="user icon"><a href="mailto:Dhawkins@facet.com">David</a></li>
<li class="user icon"><a href="mailto:patrick.f.king@gmail.com">Patrick</a></li>
<li class="user icon"><a href="mailto:robert.ag.post@gmail.com">Robert</a></li>
<li class="user icon"><a href="mailto:rmelzer@facet.com">Roseline</a></li>
<li class="user icon"><a href="mailto:yghanam@gmail.com">Yaser</a></li>
</ul>
</div>


<h1>Groups</h1>

<button onclick="$(this).newGroup();">+</button>

<ul class="apple" id = "groupList">
<li class = "icon group connectedSortable">

<div class = "name" onclick="$(this).hide5();">NSERC</div>
<ul class = "apple">
</ul>

</li>


<li class = "icon group connectedSortable">
<div class = "name" onclick='$(this).hide5();'>Facet</div>

<ul class = "apple">
</ul>

</li>
</ul>


</body>

</html>